<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Starting11</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Bungee|Bungee+Hairline|Bungee+Inline|Bungee+Shade" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Dosis:400,600" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.materialdesignicons.com/2.4.85/css/materialdesignicons.min.css">
    <!-- start Mixpanel --><script type="text/javascript">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
mixpanel.init("d22e352085b6dbf03f521a2ab2734060");</script><!-- end Mixpanel -->
</head>

<body>
    <script src="data.js"></script>
    <div class="canvas green">
        <div class="front active">
            <h2>starting<span>11</span></h2>
            <button>Start a game</button>
            <div class="btn-rules">Rules below<br><i class="mdi mdi-arrow-down"></i></div>
        </div>
        <div class="rules active">
            <h2>Rules</h2>
            <p>Starting11 is a simple but difficult quiz game!
            This is the original rules, but you are free to make your own :)</p>
            
            <h5> The basics</h5>
            <ul>
                <li>The game consist of two teams and one game master</li>
                <li>The game master will be responsible for checking off the teams answers</li>
                <li>Each team can consist of multiple members or you can have more the 2 teams</li>
            </ul>
            
            <h5>How to play</h5>
            <ul>
                <li>Select a World Cup, select a round and select a game</li>
                <li>Starting with the first team they now have to guess a starting player from any of teams</li>
                <li>Then the second team has to guess a starting player</li>
                <li>The first team that misses twice have lost the game and will buy a round of beers!</li>
          </ul>
           
        </div>
        <div class="years">
            <h3><i class="mdi mdi-chevron-left"></i>World Cups</h3>
            <button onclick="addTag(1990)"><img src="italy.png"/>Italy 1990</button>
            <button onclick="addTag(1994)"><img src="usa.png"/>USA 1994</button>
            <button onclick="addTag(1998)"><img src="france.png"/>France 1998</button>
            <button onclick="addTag(2002)"><img src="japan.png"/>Japan 2002</button>
            <button onclick="addTag(2006)"><img src="germany.png"/>Germany 2006</button>
            <button onclick="addTag(2010)"><img src="south-africa.png"/>South Africa 2010</button>
            <button onclick="addTag(2014)"><img src="brazil.png"/>Brazil 2014</button>
        </div>
        <div class="rounds">
            <h3><i class="mdi mdi-chevron-left"></i>Rounds</h3>
            <button onclick="addTag('group')">group</button>
            <button onclick="addTag('last-16')">last-16</button>
            <button onclick="addTag('quarter-finals')">quarter-finals</button>
            <button onclick="addTag('semi-finals')">semi-finals</button>
            <button onclick="addTag('3rd-place-match')">3rd-place-match</button>
            <button onclick="addTag('final')">final</button>
        </div>
        <div class="games">
            <h3><i class="mdi mdi-chevron-left"></i>Games</h3>
            <div class="pop-games"></div>
        </div>
        <div class="game">
            <h3><i class="mdi mdi-chevron-left"></i>Game</h3>
            <div class="header"></div>

            <div class="home-team-header"></div>
            <div class="home-team"></div>

            <div class="away-team-header"></div>
            <div class="away-team"></div>

        </div>
    </div>
    <script type="text/javascript">
    var selectedTags = [];

    function resetTags() {
        window.selectedTags = [];
        console.log('reset');
        $(".pop-games").empty();
    }

    function addTag(tag) {
        window.selectedTags.push(tag);
        mixpanel.track("Added tag", {
          'tag': tag
        });
        console.log(window.selectedTags);
        // search();
    }

    function removeLastTag(){
        window.selectedTags = window.selectedTags.splice(0,1)
        console.log(window.selectedTags);
        mixpanel.track("Go back");
    }

    function search() {
        selectedTags = window.selectedTags;
        var filtered = tags.filter(function(element) {
            var cats = element.tags;
            return cats.filter(function(cat) {
                return selectedTags.indexOf(cat) > -1;
            }).length === selectedTags.length;
        });
        filtered.forEach(function(element) {
            console.log(matches[element.id]);
            $(".pop-games").append(matches[element.id].home_team + " - " + matches[element.id].away_team + "<br><br>")
        });
    }

    function addGames() {
        $(".pop-games").empty();
        selectedTags = window.selectedTags;
        var filtered = tags.filter(function(element) {
            var cats = element.tags;
            return cats.filter(function(cat) {
                return selectedTags.indexOf(cat) > -1;
            }).length === selectedTags.length;
        });
        filtered.forEach(function(element) {
            $(".pop-games").append("<button match_id='" + element.id + "'><span>" + matches[element.id].home_team + " - " + matches[element.id].away_team + "</span><span>" + matches[element.id].score + "</span></button>")
        });

        $(".pop-games > button").click(function() {
            $(".games").removeClass("active");
            $(".game").addClass("active");
            match_id = this.getAttribute('match_id');
            playGame(match_id);
        });

    }

    function playGame(match_id) {

        match = matches[match_id];
        $(".game > .header").empty();
        $(".game > .home-team").empty();
        $(".game > .away-team").empty();
        $(".game > .home-team-header").empty();
        $(".game > .away-team-header").empty();

        console.log("Started playing match: ", match);
        console.log(window.selectedTags);
        $(".game > .header").append("<span>" + match.home_team + " - " + match.away_team + "</span><span>" + match.score + "</span>");
        $(".game > .home-team-header").append('<span>' + match.home_team + '</span');
        $(".game > .away-team-header").append('<span>' + match.away_team + '</span');

        match.home_players.forEach(function(player){
          $(".game > .home-team").append('<div class="player"><span><img src="player.png"></span><span>' + player.name + "</span><span>" + player.position + "</span></div>");
        });

        match.away_players.forEach(function(player){
         $(".game > .away-team").append('<div class="player"><span><img src="player.png"></span><span>' + player.name + "</span><span>" + player.position + "</span></div>");
        });

        $(".game .player").click(function(element) {
            $(this).toggleClass("selected");
            mixpanel.track("Selected a player", {
              'player_id': element.id
            });
        });
        mixpanel.track("Started a match", {
          'match_id': match_id
        });

    }

    function selectPlayer(element){
      $(this).toggleClass("selected");

    }

    $(".front > button").click(function() {
        $(this).parent().removeClass("active");
        $(".canvas").removeClass("green");
        $(".rules").removeClass("active");
        $(".years").addClass("active");
    });

    $(".years > button").click(function() {
        $(this).parent().removeClass("active");
        $(".rounds").addClass("active");
    });

    $(".rounds > button").click(function() {
        $(this).parent().removeClass("active");
        $(".games").addClass("active");
        addGames();
    });


    $(".rounds .mdi-chevron-left").click(function() {
        $(this).parent().parent().removeClass("active");
        $(".years").addClass("active");
        resetTags();
    });

    $(".games .mdi-chevron-left").click(function() {
        $(this).parent().parent().removeClass("active");
        $(".rounds").addClass("active");
        removeLastTag();
    });

    $(".game .mdi-chevron-left").click(function() {
        $(this).parent().parent().removeClass("active");
        $(".games").addClass("active");
    });
    </script>
</body>

</html>
